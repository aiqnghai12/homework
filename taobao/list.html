<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        </style> 
</head>
<script src="https://cdn.bootcdn.net/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<body>


<div class="goods">
    <!-- <ul>
        <li>
            <img src="" alt="">
            <p></p>
        </li>
    </ul> -->
</div>
 
    <script>
        
// <!-- http://10.31.162.16/new/homework/taobao/list.html -->
const url = "http://10.31.162.16/taobao/"
class ajaxfunction {
            constructor(url,data) {
             this.url = url;
             this.data = data;
            }
            init() {
                $.ajax({
                    type: "get",// get或者post
                    url:  this.url+"php/list.php",// 请求的url地址
                    data:{},//请求的参数
                    //  dataType:"json",//json写了jq会帮我们转换成数组或者对象 他已经用JSON.parse弄好了 
                    timeout: 3000,//3秒后提示错误
                    //  beforeSend:function(){ 
                    //  // 发送之前就会进入这个函数
                    //  // return false 这个ajax就停止了不会发 如果没有return false 就会继续
                    //  },
                    success: function (data) { // 成功拿到结果放到这个函数 data就是拿到的结果
                    data = JSON.parse(data);
                    new ce(data).creat();
                    },
                    error: function () {//失败的函数
                        console.log("err");
                    }, complete: function () {//不管成功还是失败 都会进这个函数
                    }
                })
            }
        }


class ce{
            constructor(data){
                this.data = data; 
                this.smallpic = document.querySelector(".smallpic img");
                this.bigpic = document.querySelector(".bf .bigpic");
                this.imgmin = document.querySelector(".imgmin");
                this.ul;
            }
      creat(){
       const divs = document.querySelector(".goods");
       Object.assign(divs.style,{width:"1400px",margin:"50px auto",position:"relative",top:"100px"});
       var Listli = [];
       this.data.forEach((item,index) => {
        Listli[index] = this.ce("li",{overflow:"hidden", listStyle:"none", width:"220px",height:"380px",border:"1px solid #000",float:"left",position:"relative",margin:"3px"},divs);
       this.ce("img",{width:"200px",height:"200px",margin:"10px"},Listli[index]).src =  item["url"];
       this.ce("p",{width:"200px",height:"50px",fontSize:"16px",margin:"5px auto"},Listli[index]).textContent = item["title"];
       this.ce("p",{width:"100px",height:"20px",margin:"10px 0 0 100px"},Listli[index]).textContent =  "￥"+item["price"];
       this.ce("p",{width:"100px",margin:"10px 0 0 100px",fontSize:"12px",color:"#ccc"},Listli[index]).textContent =  "已售出數量"+item["sailnumber"];
       this.ce("div",{width:"220px",height:"350px",background:"rgba(0,0,0,0)",position:"absolute",zIndex:"200",top:"0",left:"0"},Listli[index]).index=index;
       

       Listli[index].addEventListener("click",(e)=>{
           window.location.href = url+"goods.html?"+item.sid;
       })
    });
      }


// liHander(e){
    
// }

    //   creatimgmins(e){
    //     //  this.imgmin.innerHTML = "";
    //     this.smallpic.src = this.data[e.target.index]["url"];
    //     this.bigpic.src  = this.data[e.target.index]["url"];
    //     if(this.data[e.target.index]['piclisturl']){
    //     let datapiclisturl = this.data[e.target.index]['piclisturl'].split(",");
    //     // this.imgsmin(datapiclisturl);
    //     }
    //     this.timer = setInterval(()=>{
    //         document.documentElement.scrollTop -=200 ;
    //         if(document.documentElement.scrollTop<=0)
    //         clearInterval(this.timer);
    //     },16)
    //   }

    //   imgsmin(datapiclisturl){
    //     this.imgmin.mins = [];
    //     this.imgmin.innerHTML = "";
    //     this.ul = this.ce("div",{height:"50px",width:`${datapiclisturl.length*70}px`,paddingTop:"1px",display:"block",position:"absolute",top:0,left:0,paddingLeft:"7px"},this.imgmin)
    //     datapiclisturl.forEach((item,index)=>{
    //         this.imgmin.mins[index] = this.ce("img",{width:"40px",height:"48px",display:"inline",marginLeft:index!==0? "15px":"0"},this.ul);
    //         this.imgmin.mins[index].src = item;
    //         this.imgmin.mins[index].index = index;
    //         this.imgmin.mins[index].addEventListener("click",(e)=>{
    //             this.smallpic.src =  e.target.src;
    //             this.bigpic.src  =  e.target.src;
    //         })
    //     })
    //     this.ul.leng = datapiclisturl.length;
    //   this.drag(this.ul) ;
    //     // ul.addEventListener("mousedown",ulmouseHandler);
    //   }
     
ce(type,style,parent){
   let elem = document.createElement(type);
   Object.assign(elem.style,style);
   if(parent){
       parent.appendChild(elem);
   }
   return elem;
}

// drag(obj) {
//             obj.onmousedown = function(ev){
//               var ev = ev || window.event;
//               let shortx ;
//               if(ev.target.tagName=="DIV"){
//                 shortx = ev.offsetX+30;
//                }else{
//                    shortx =ev.offsetX+(ev.target.index+1)*55-18;
//                }
//                let length = this.leng;
//                 document.onmousemove = function (ev) {
//                     var ev = ev || window.event;
//                     obj.style.left = ev.clientX - shortx + 'px';
//                     if(ev.clientX - shortx>=0){
//                         obj.style.left = 0;
//                     }
//                     if(ev.clientX - shortx<=450-(length-1)*55){
//                         console.log(obj.style.left);
//                         obj.style.left =450-(length-1)*55+"px";
//                     }
//                     // console.log(obj.style.left);
//                 };
//                 document.onmouseup = function () {
//                     document.onmousemove = null;
//                     document.onmouseup = null;
//                 };
//                 return false;
//             }
//         }
        }
// class Scale {
//             constructor() {
//                 this.scale = document.querySelector('.scale');
//                 this.smallpic = document.querySelector('.smallpic');
//                 this.sf = document.querySelector('.sf');
//                 this.bigpic = document.querySelector('.bigpic');
//                 this.bf = document.querySelector('.bf');
         
//             }
//             init() {
//                 this.scale.style.position = "relative";
//                 this.scale.style.top = "-50px"
//                 //1.鼠标移入移出小图，小放和大放会对应显示和隐藏。
//                 this.smallpic.onmouseover = () => {
//                     this.sf.style.visibility = 'visible';
//                     this.bf.style.visibility = 'visible';
//                     //2.鼠标移入求小放的尺寸。
//                     this.sf.style.width = this.smallpic.offsetWidth * this.bf.offsetWidth / this.bigpic.offsetWidth + 'px';
//                     this.sf.style.height = this.smallpic.offsetHeight * this.bf.offsetHeight / this.bigpic.offsetHeight + 'px';
//                     //3.比例，注意比例一定要大于1(放大操作)，一定大的比小的。
//                     this.bili = this.bigpic.offsetWidth / this.smallpic.offsetWidth;
//                     //4.鼠标移动的时候，小放跟随鼠标
//                     this.smallpic.onmousemove = (ev) => {
//                         var ev = ev || window.event;
//                         this.move(ev);
//                     }
//                 };

//                 this.smallpic.onmouseout = () => {
//                     this.sf.style.visibility = 'hidden';
//                     this.bf.style.visibility = 'hidden';
//                 };
//             }
//             move(ev) {
//                 let leftvalue = ev.clientX - this.scale.offsetLeft - this.sf.offsetWidth / 2;
//                 let topvalue = ev.clientY - this.scale.offsetTop - this.sf.offsetHeight / 2;
//                 if (leftvalue < 0) {
//                     leftvalue = 0;
//                 } else if (leftvalue >= this.smallpic.offsetWidth - this.sf.offsetWidth) {
//                     leftvalue = this.smallpic.offsetWidth - this.sf.offsetWidth
//                 }
//                 if (topvalue < 0) {
//                     topvalue = 0;
//                 } else if (topvalue >= this.smallpic.offsetHeight - this.sf.offsetHeight) {
//                     topvalue = this.smallpic.offsetHeight - this.sf.offsetHeight
//                 }
//                 this.sf.style.left = leftvalue + 'px';
//                 this.sf.style.top = topvalue + 'px';
//                 this.bigpic.style.left = -leftvalue * this.bili + 'px';
//                 this.bigpic.style.top = -topvalue * this.bili + 'px';
//             }

//         }

        new ajaxfunction(url).init();
        </script>
</body>

</html>